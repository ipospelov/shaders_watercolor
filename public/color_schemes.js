function rgb (v1, v2, v3) {
    return [v1, v2, v3];
}

var palettes = [
    [
        [55, 226, 213],
        [89, 6, 150],
        [199, 10, 128],
        [251, 203, 10]
    ],
    [
        rgb(35, 30, 35),
        rgb(57, 166, 163),
        rgb(222, 238, 234),
        rgb(191, 19, 99)
    ],
    [
        rgb(0, 184, 169),
        rgb(248, 243, 212),
        rgb(246, 65, 108),
        rgb(255, 222, 125),
    ],
    [
        rgb(0, 255, 209),
        rgb(49, 198, 212),
        rgb(255, 255, 0),
        rgb(255, 30, 30),
    ],
    [
        rgb(49, 225, 247),
        rgb(216, 0, 166),
        rgb(255, 119, 119),
        rgb(64, 13, 81),
    ],
    [
        rgb(47, 164, 255),
        rgb(0, 255, 221),
        rgb(232, 255, 194),
        rgb(14, 24, 95),
    ],
    [
        rgb(172, 68, 37),
        rgb(193, 213, 164),
        rgb(34, 75, 12),
        rgb(240, 242, 182)
    ],
    [
        rgb(255, 166, 213),
        rgb(142, 5, 5),
        rgb(156, 192, 148),
        rgb(255, 247, 224)
    ],
    [
        rgb(241, 243, 244),
        rgb(121, 186, 193),
        rgb(42, 120, 134),
        rgb(81, 43, 88)
    ],
    [
        rgb(120, 28, 104),
        rgb(49, 157, 160),
        rgb(255, 211, 154),
        rgb(255, 245, 225)
    ],
    [
        rgb(125, 30, 106),
        rgb(238, 176, 176),
        rgb(255, 229, 157),
        rgb(189, 230, 241)
    ],
    [
        rgb(205, 240, 234),
        rgb(249, 249, 249),
        rgb(236, 197, 251),
        rgb(250, 244, 183)
    ],
    [
        rgb(214, 125, 62),
        rgb(156, 15, 72),
        rgb(249, 228, 212),
        rgb(71, 13, 33)
    ],
    [
        rgb(167, 210, 203),
        rgb(242, 211, 136),
        rgb(201, 132, 116),
        rgb(135, 76, 98)
    ],
    [
        rgb(41, 52, 98),
        rgb(242, 76, 76),
        rgb(236, 155, 59),
        rgb(247, 215, 22)
    ],
    [
        rgb(235, 83, 83),
        rgb(249, 217, 35),
        rgb(54, 174, 124),
        rgb(24, 116, 152)
    ],
    [
        rgb(35, 25, 85),
        rgb(232, 170, 66),
        rgb(31, 70, 144),
        rgb(255, 229, 180)
    ],
    [
        rgb(41, 52, 98),
        rgb(214, 28, 78),
        rgb(254, 177, 57),
        rgb(255, 248, 10)
    ],
    [
        rgb(255, 233, 160),
        rgb(54, 126, 24),
        rgb(245, 115, 40),
        rgb(204, 54, 54)
    ],
    [
        rgb(255, 245, 228),
        rgb(255, 196, 196),
        rgb(238, 105, 131),
        rgb(133, 14, 53)
    ],
    [
        rgb(240, 234, 190),
        rgb(33, 225, 225),
        rgb(59, 154, 225),
        rgb(49, 32, 224)
    ],
    [
        rgb(124, 62, 102),
        rgb(242, 235, 233),
        rgb(165, 190, 204),
        rgb(36, 58, 115)
    ],
    [
        rgb(55, 125, 113),
        rgb(251, 197, 197),
        rgb(251, 161, 161),
        rgb(136, 121, 176)
    ],
    [
        rgb(36, 161, 156),
        rgb(250, 238, 231),
        rgb(50, 82, 136),
        rgb(217, 96, 152)
    ],
    [
        rgb(185, 22, 70),
        rgb(223, 216, 202),
        rgb(251, 243, 228),
        rgb(16, 86, 82)
    ],
    [
        rgb(132, 84, 96),
        rgb(234, 211, 203),
        rgb(189, 199, 201),
        rgb(43, 79, 96)
    ],
    [
        rgb(255, 238, 208),
        rgb(247, 159, 36),
        rgb(241, 45, 45),
        rgb(124, 6, 77)
    ],
    [
        rgb(255, 248, 243),
        rgb(163, 228, 219),
        rgb(28, 109, 208),
        rgb(254, 209, 239)
    ],
    [
        rgb(234, 92, 43),
        rgb(255, 127, 63),
        rgb(246, 216, 96),
        rgb(149, 205, 65)
    ],
    [
        rgb(20, 47, 67),
        rgb(255, 171, 76),
        rgb(255, 95, 126),
        rgb(176, 0, 185)
    ],
    [
        rgb(100, 100, 100),
        rgb(88, 0, 255),
        rgb(233, 0, 255),
        rgb(255, 198, 0)
    ],
    [
        rgb(244, 244, 244),
        rgb(101, 238, 183),
        rgb(255, 87, 34),
        rgb(71, 71, 68)
    ],
    [
        rgb(22, 165, 150),
        rgb(137, 139, 138),
        rgb(250, 224, 223),
        rgb(246, 245, 241)
    ],
    [
        rgb(102, 191, 191),
        rgb(234, 246, 246),
        rgb(255, 255, 255),
        rgb(255, 0, 99)
    ],
    [
        rgb(218, 221, 223),
        rgb(246, 147, 20),
        rgb(196, 11, 19),
        rgb(98, 18, 149),
    ],
    [
        rgb(233, 82, 128),
        rgb(35, 177, 165),
        rgb(255, 221, 126),
        rgb(243, 243, 243)
    ],
    [
        rgb(40, 82, 122),
        rgb(138, 196, 208),
        rgb(244, 209, 96),
        rgb(251, 238, 172)
    ],
    [
        rgb(84, 99, 255),
        rgb(236, 236, 236),
        rgb(255, 195, 0),
        rgb(255, 24, 24)
    ]
]

function mixColors(color1, color2, intensity) {
    return color1.map((n, i) => {
        var diff = color2[i] - n;
        var toAdd = map(intensity, 0, 1, 0, diff);
        return n + toAdd
    });
}

var colorRanges = [
    [0, 0.1],
    [0.1, 0.2],
    [0.2, 0.3],
    [0.3, 0.4],
    [0.4, 0.5],
    [0.5, 0.6],
    [0.6, 0.7],
    [0.7, 0.8],
    [0.8, 0.9],
    [0.9, 1]
]

function multipleMixColors(color1, color2, height, noiseGenerator) {
    var p1 = 0, p2 = 1;
    for (var range of noiseGenerator.colorPercentiles) {
        p1 = range[0];
        p2 = range[1];
        if (height >= p1 & height <= p2) {
            break;
        }
    }

   var intensity = map(height, p1, p2, 0, 1);
   return mixColors(color1, color2, intensity);
}


function buildPalette() {
    var hue = randomInt(0, 360);
    var hue2 = (hue + 10) % 360;
    var palette = [
        [hue, 30, 100],
        [(hue + 90) % 360, 30, 100],
        [hue2, 100, 100],
        [(hue2 + 90), 100, 100],
    ];
    return palette;
}